# DigiPass

## Downloading the files

```bash
git clone https://github.com/IbrahimSiddiqui007/DigiPass.git
```
Go into the folder

```bash
cd DigiPass
```
Install all necessary dependencies

```bash
npm install
```

## Downloading and Running the Blockchain

### Installing Ganache and getting it running

#### Please install Ganache using the following link:
[Ganache install](https://trufflesuite.com/ganache/)

#### After installing ganache, open it and you will see the following:
![image](https://github.com/IbrahimSiddiqui007/DigiPass/assets/87603789/51f08d4e-a719-42e0-8b41-e62236c651c1)


#### In your case however, you will not have a created workspace.

#### Next, click on the "New workspace" button and you will be presented with the following screen:
![image](https://github.com/IbrahimSiddiqui007/DigiPass/assets/87603789/9fc94c70-68a9-4013-bd41-b91d117da727)

#### Next click on server and then click on HOSTNAME.
![image](https://github.com/IbrahimSiddiqui007/DigiPass/assets/87603789/7d4cc711-4e86-4c21-9ec8-e4a4c33d06a6)

#### In my case I have 2 ethernet connections and I will select the first one. You may select any of the ethernet connections that are available to you.
![image](https://github.com/IbrahimSiddiqui007/DigiPass/assets/87603789/7181b24f-920b-4840-9d71-492df4ebe7c6)

#### If you would Like to add or decrease the number of accounts then you can go to the Accounts & keys sections and adjust the amount of accounts to your liking.

#### At this point you can click on start and you will be presented with the following.
![image](https://github.com/IbrahimSiddiqui007/DigiPass/assets/87603789/0aa5eb34-23e1-4224-b04e-04d9dba18cf3)

#### Please do remember that things like account address, rpc server and mnemonic will not be the same on your machine as those are randomy generated by ganache or something that you selected.

### Deploying the contract

#### After getting ganache running go back to the files and run the following command in the terminal

```bash
npm install -g truffle
```

#### After it is finished installing run the following command

```bash
truffle init Blckchain
```
![image](https://github.com/IbrahimSiddiqui007/DigiPass/assets/87603789/678a7433-777b-4508-81a2-3c0f8754a715)

#### After the above command has finish running open the newly created folder in your editor of choice. Mine is visual studio code. These are the files and folders that are created with.
![image](https://github.com/IbrahimSiddiqui007/DigiPass/assets/87603789/17248c2d-7794-449a-a19f-d1aad1368cb9)

#### Now within the Truffle-config.js file delete everything and paste the following.

```javascript

module.exports = {
  networks: {
    development: {
      host: "192.168.1.86",
      port: 7545,
      network_id: "*", // Match any network id
    }
  },
  solc: {
    settings: {
      optimizer: {
        enabled: true, // Default: false
        runs: 200      // Default: 200
      },
    }
  }
};

```
#### Change the IP address to one specified by the RPC server in ganache. Your RPC server IP address might be different.
![image](https://github.com/IbrahimSiddiqui007/DigiPass/assets/87603789/cb6b4576-3aa5-4b7c-8cbb-92c8cb4d6e49)

#### Now create 4 files. 2 In the contracts folder and 2 in the migrations folder. Keep the names of the files exactly as I have them especially the files in the migration folder.
![image](https://github.com/IbrahimSiddiqui007/DigiPass/assets/87603789/97b80594-b087-471b-9433-c67748f988eb)

#### As for the content of the files 
#### Migrations.sol

```solidity
pragma solidity ^0.5.16;

contract Migrations {
  address public owner;
  uint256 public last_completed_migration;

  modifier restricted() {
    if (msg.sender == owner) _;
  }

  constructor() public {
    owner = msg.sender;
  }

  function setCompleted(uint completed) public restricted {
    last_completed_migration = completed;
  }

  function upgrade(address new_address) public restricted {
    Migrations upgraded = Migrations(new_address);
    upgraded.setCompleted(last_completed_migration);
  }
}
```
#### Test.sol

```solidity
pragma solidity ^0.5.16;

contract test {
    struct bio {
        uint uid; // Unified ID
        string Bval; // Biometric value
        string location; // Which location of the type of fingerprint
        string biometricType; // Which fingerprint is it (as a string)
    }

    mapping(address => bio[]) private BioRecords;

    event BiometricStored(address indexed owner, uint uid, string Bval, string location, string biometricType, uint256 timestamp);

    function addBD(uint uid, string memory Bval, string memory location, string memory biometricType) public {
        bio memory record = bio({
            uid: uid,
            Bval: Bval,
            location: location,
            biometricType: biometricType
        });

        BioRecords[msg.sender].push(record);
        emit BiometricStored(msg.sender, uid, Bval, location, biometricType, block.timestamp);
    }

    function getBiometricDataCount() public view returns (uint256) {
        return BioRecords[msg.sender].length;
    }

    function getBiometricData(uint256 index) public view returns (uint, string memory, string memory, string memory) {
        require(index < BioRecords[msg.sender].length, "Index out of bounds");
        bio storage record = BioRecords[msg.sender][index];
        return (record.uid, record.Bval, record.location, record.biometricType);
    }
}
```

#### 1_initial_migration.js

```javascript
const Migrations = artifacts.require("./Migrations.sol");


module.exports = function(deployer) {
  deployer.deploy(Migrations);

};
```

#### 2_deploy_contracts.js

```javascript
const test = artifacts.require("test");


module.exports = function(deployer) {
  deployer.deploy(test);

};
```

#### Now go into the terminal and CD into the folder called blckchain

```bash
cd blckchain

truffle migrate
```

#### Hopefully after running that you will get the following text in the terminal. 

![image](https://github.com/IbrahimSiddiqui007/DigiPass/assets/87603789/a9d6c4ce-f7a9-45d1-bc0c-54023fda90b8)

#### If you open ganache you will see the following under the contracts section
![image](https://github.com/IbrahimSiddiqui007/DigiPass/assets/87603789/a44a772b-eb62-4967-8aed-9c559a85be65)


## Connecting the blockchain and the database to the application



## Running the application
#### Now create 2 fresh terminal sessions

#### Run the following commmands in both sessions

```bash
CD Digipass
```

#### Now in the first terminal session run the following command

```bash
cd server

npm start
```

#### While doing that run the following commands in the second terminal session

```bash
cd screens

npm start
```
